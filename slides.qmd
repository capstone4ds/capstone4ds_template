---
title: "Bayesian Logistic Regression for Diabetes Risk (NHANES 2013–2014)"
subtitle: "Capstone Presentation"
author:
  - "Namita Mishra"
  - "Autumn Wilcox"

advisor: "Dr. Ashraf Cohen"
format:
  revealjs:
    theme: simple
    slide-number: true
    transition: slide
    css: slides.css
    incremental: true   
    
    
bibliography: references.bib
execute:
  warning: false
  message: false
  echo: false
---

```{=html}
<style>
.reveal {

  font-size: 34px; /* change all slide text */
  }
.reveal h1 {
  font-size: 48px; /* title font */
  
}

</style>
```

## Aim: Early identification of risk factors is key to Diabetes diagnosis and prevention

Predict diabetes using Bayesian logistic regression

**Challenges Frequentists** - maximum likelihood estimation is unstable in missing data, quasi-separation, or small samples

**Bayesian Method** - flexible, regularize estimates, quantify uncertainty under missingness or imputation ( Baldwin and Larson 2017; Kruschke and Liddell 2017) - incorporate prior, provide credible intervals via Markov Chain Monte Carlo (MCMC) to predict patient health status across diseases - Support model checking, variable selection, and uncertainty quantification

![](images/clipboard-2249834790.png){fig-align="center" width="361"}

------------------------------------------------------------------------

## Bayesian Logistic Regression

Outcome: `diabetes_dx` (0 = non-diabetic, 1 = diabetic)

Predictors: `age_c`, `bmi_c`, `sex`, `race`.

-   Intercept prior: student_t(3, 0, 10) — allows heavy tails for flexibility in the intercept estimate. @VanDeSchoot2013

-   Regression coefficients prior: normal(0, 2.5) — providing weakly informative regularization, constraining extreme values without overpowering the data. @VandeSchoot2021

-   Implemented in `brms` (Stan backend), Posterior draws = 4000 (4 chains × 1000 iterations).

    ![](images/clipboard-87871382.png){width="371" height="86"}

-   Logistic link function

------------------------------------------------------------------------

## Bayesian Model Equation

```{undefined}
#| eval: false
#| include: false
library(gt)
priors <- c(
  set_prior("normal(0, 2.5)", class = "b"),
  set_prior("student_t(3, 0, 10)", class = "Intercept") 
)
bayes_fit <- brm(
  formula = diabetes_dx | weights(wt_norm) ~ age_c + bmi_c + sex + race,
  data    = adult_imp1,
  family  = bernoulli(link = "logit"),
  prior   = priors,
  chains  = 4, iter = 2000, seed = 123,
  control = list(adapt_delta = 0.95),
  refresh = 0   # quiet Stan output
)
```

$$
\text{logit}(P(Y=1)) = \beta_0 + \beta_1 \text{age}_c + \beta_2 \text{bmi}_c + \beta_3 \text{sex} + \beta_4 \text{race}
$$

-   P(Y=1) : Probability of being diabetic
-   Coefficients estimated with posterior means and 95% credible intervals.

------------------------------------------------------------------------


## Data: Survey weighted: National Health and Nutrition Examination Survey dataset (2013-2014) (NHANES)

\- Study population: Adults (\>20 years)(n=5769): - `Age`: evenly distributed across adult age groups - `BMI`: concentrated in the overweight and obese ranges - `Female` \> `Male` participants - **most participants are non-diabetic**, a **minority are diabetic**: a relatively lower prevalence of diabetes in the sample - Predictors: age, sex, race, BMI - Response variable: `diabetes_dx` (diagnosis: 0 = No, 1 = Yes) `r head(adult)`

![](images/clipboard-126412730.png)

------------------------------------------------------------------------

## Missing Assessment (Overall missingness: \~4%)
::::: columns
::: {.column width="40%"}
![](images/clipboard-1235247978.png){width="339"}
:::

::: {.column width="60%"}

No variable is completely missing. Missingness is likely *MAR* (Missing At Random) and is clustered mainly in bmi (4.3%) and diabetes_dx (3.1%).

:::
:::::
Apply **Multiple Imputation by Chained Equations (MICE)**.

------------------------------------------------------------------------

## Multiple Imputation by Chained Equations (MICE): Handles missing data

*(van Buuren & Groothuis-Oudshoorn, 2011; van Buuren, 2012)*

``` r
  glm(diabetes_dx ~ age_c + bmi_c + sex + race, family = binomial()) }) pool_mi <- pool(fit_mi) 
```

-   It iteratively imputes incomplete variables using regression models\
-   **PMM** for continuous variables; **logistic regression** for binary variables\
-   **5 imputations × 10 iterations** for stability and convergence\
-   Estimates **pooled using Rubin’s rules** to account for uncertainty\
-   **Trace plots** confirm convergence and consistency with original data


-   Model significance: All predictors are statistically significant (p \< 0.01), suggesting a robust association across demographic and health variables.

------------------------------------------------------------------------

## Bayesian Model Diagnostics (MCMC)

-   Rhat ≈ 1.00 → convergence achieved.

-   Bulk ESS \> 3000 for all parameters → good mixing.

-   Trace plots showed stable sampling across chains.

-   Posterior distributions were unimodal and well-centered.

    ![](images/clipboard-353929734.png){width="366"}

------------------------------------------------------------------------

## Posterior Estimates

| Predictor | Estimate | 95% CI           | Interpretation                     |
|-----------|----------|------------------|------------------------------------|
| Intercept | -2.66    | \[-2.84, -2.50\] | Baseline log-odds                  |
| Age_c     | 1.09     | \[0.97, 1.22\]   | ↑ age increases diabetes risk      |
| BMI_c     | 0.88     | \[0.76, 1.01\]   | Higher BMI linked with higher risk |
| HTN       | 0.65     | \[0.50, 0.81\]   | Hypertension predicts diabetes     |

------------------------------------------------------------------------

## Posterior Predictive Distribution

``` r
#| echo: true
library(ggplot2)

ggplot(combined_draws, aes(x = estimate, fill = type)) +
  geom_density(alpha = 0.4) +
  facet_wrap(~ term, scales = "free", ncol = 2) +
  theme_minimal(base_size = 13) +
  labs(
    title = "Prior vs Posterior Distributions",
    x = "Coefficient estimate",
    y = "Density",
    fill = ""
  )
```

![](Prior%20vs%20Posterior%20Distributions_bmi_age.png){width="296"}

------------------------------------------------------------------------

## Model Interpretation

-   Strong positive relationship between **age**, **BMI**, and diabetes probability.
-   Posterior predictive checks: model captures data patterns well.
-   Imputation reduced bias and improved model robustness.

------------------------------------------------------------------------

## Limitations

-   NHANES data are cross-sectional → no causal inference.
-   Potential unmeasured confounding (diet, physical activity).
-   Limited predictors → simplified model structure.
-   Imputation assumes MAR; violations may introduce bias.

------------------------------------------------------------------------

## Conclusion

-   Bayesian logistic regression effectively models uncertainty.
-   MICE improved data completeness and reliability.
-   Posterior predictions provide interpretable probabilities for diabetes risk.
-   Framework adaptable to other health outcomes (e.g., hypertension, obesity).

------------------------------------------------------------------------

## References

-   van Buuren S., Groothuis-Oudshoorn K. (2011). *MICE: Multivariate Imputation by Chained Equations in R.*
-   Gelman A., Hill J. (2007). *Data Analysis Using Regression and Multilevel/Hierarchical Models.*
-   NHANES Data Documentation (CDC).
-   McElreath R. (2020). *Statistical Rethinking: A Bayesian Course with Examples in R and Stan.*

------------------------------------------------------------------------

## Acknowledgements

-   Faculty: Dr. Ashraf Cohen, PhD, MS

-   University of West Florida, Department: Mathematics and Statistics

    ```         
            Thanks for the guidance
    ```

------------------------------------------------------------------------

## References
